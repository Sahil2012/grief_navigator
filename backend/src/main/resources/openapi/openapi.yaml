openapi: 3.0.1
info:
  title: Grief Navigator API
  version: 1.0.0

servers:
  - url: /api

paths:
  /loss/register:
    post:
      operationId: registerLosses
      summary: Register losses
      tags:
        - Loss
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: "#/components/schemas/LossDTO"
      responses:
        "200":
          description: Loss registered successfully
        "400":
          description: Bad request

  /loss:
    get:
      operationId: getAllLosses
      summary: Get all losses for a perticular user
      tags:
        - Loss
      responses:
        "200":
          description: A list of losses
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/LossDTO"
        "500":
          description: Internal server error

  /auth/me:
    get:
      operationId: getMyAppUser
      summary: Register a new app user
      tags:
        - AppUser
      responses:
        "200":
          description: App user registered successfully
        "400":
          description: Bad request

  /difficultTimes:
    post:
      operationId: registerDifficultTimes
      summary: Save difficult difficultTimes
      tags:
        - DifficultTimes
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: "#/components/schemas/DifficultTimes"
      responses:
        "200":
          description: Difficulties acknowleged
        "400":
          description: Bad request

  /profile:
    get:
      operationId: getMyProfile
      summary: Get current user profile
      tags:
        - Profile
      responses:
        "200":
          description: Profile fetched successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ProfileDTO"
        "400":
          description: Bad request
        "500":
          description: Internal server error
    patch:
      operationId: updateProfile
      summary: Update current user profile
      tags:
        - Profile
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ProfileDTO"
      responses:
        "200":
          description: Profile updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ProfileDTO"
        "400":
          description: Bad request

  
  /beliefStatement:
    get:
      operationId: getBeliefStatements
      summary: Fetch pre defined beliefStatement
      tags:
        - BeliefStatement
      responses:
        "200":
          description: Fetch beliefStatement
          content:
            application/json:
              schema:
                type: array
                items: 
                  type: object
        "400":
          description: Bad request
              
    post:
      operationId: saveBeliefStatements
      summary: Save beliefStatement
      tags:
        - BeliefStatement
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: array
              items:
                type: string
      responses:
        "200":
          description: Fetch beliefStatement
        "400":
          description: Bad request
  
  /beliefEntry:
    post:
      operationId: saveBeliefEntries
      summary: Save Belief Entries for a user
      tags:
        - BeliefEntry
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: array
              items: 
                $ref: '#/components/schemas/BeliefEntryDTO'
      responses:
        '200':
          description: Entires Saved successfully
        '400':
          description: Bad Request

  /avoidenceStatement:
    post:
      operationId: saveAvoidenceStatements
      tags:
        - Avoidence Statement
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: array
              items:
                type: string
      responses:
        "200":
          description: "Avoidence Statements saved successfully"
        "400":
          description: "Bad request"

    get:
      operationId: getAvoidenceStatements
      tags:
        - Avoidence Statement
      responses:
        "200":
          description: "Avoidence Statement fetched successfully"
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
        "400":
          description: "Bad Request"

  /avoidenceEntry:
    post:
      operationId: saveAvoidenceEntries
      tags:
        - Avoidence Entry
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: '#/components/schemas/AvoidenceEntryDTO'
      responses:
        "200":
          description: "Avoidence Entires saved successfully"
        "400":
          description: "Bad Request"
  
  /familyConflict/{sectionId}:
    get:
      operationId: getQuestions
      tags:
        - Family Conflict 
      parameters:
        - name: sectionId
          in: path
          required: true
          schema:
            type: string
        - name: fieldId
          in: query
          required: false
          schema:
            type: string
      responses:
        "200":
          description: "Family Conflict Questions fetched successfully"
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/FamilyConflictQuestionDTO'
        "400":
          description: "Bad Request"
  
  /familyConflict:
    post:
      operationId: saveQuestions
      tags:
        - Family Conflict
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: '#/components/schemas/FamilyConflictQuestionDTO'
      responses:
        "200":
          description: "Saved Questions successfully"
        "400": 
          description: "Bad Request"

  /familyConflict/answer:
    post:
      operationId: saveAnswers
      tags:
        - Family Conflict 
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: '#/components/schemas/FamilyConflictAnswerDTO'
      responses:
        "200":
          description: "Answers saved successfully"
        "400":
          description: "Bad Request"  
  
  /familyConflictAssessment/start:
    post:
      operationId: startAssessment
      tags:
        - Family Conflict Assessment 
      responses:
        "200":
          description: "Assessment started successfully"
          content:
            application/json:
              schema:
                type: long
        "400":
          description: "Bad Request"

  /familyConflictAssessment:
    get:
      operationId: getAssessment
      tags:
        - Family Conflict Assessment
      responses:
        "200":
          description: "Assessment fetched successfully"
          content:
            application/json:
              schema:
                type: object
        "400":
          description: "Bad Request"
  
  /familyConflictAssessment/complete:
    patch:
      operationId: completeAssessment
      tags:
        - Family Conflict Assessment
      parameters:
        - name: assessmentId
          in: query
          schema:
            type: long
      responses:
        "200":
          description: "Assessment Completed successfully"
        "400":
          description: "Bad Request"

  /profile/cyge/readiness:
    get:
      operationId: getCYGECompletionStatus
      summary: Get CYGE Completion Status
      tags:
        - CYGE
      responses:
        "200":
          description: "CYGE Completed successfully"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CompletionStatus'
        "400":
          description: "Bad Request"
  
  /profile/cyge/complete:
    patch:
      operationId: completeCYGE
      summary: Mark CYGE as complete
      tags:
        - CYGE
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CompletionStatus'
      responses:
        "200":
          description: "CYGE marked as complete successfully"
        "400":
          description: "Bad Request"
  
  /checkin:
    post:
      operationId: saveDailyCheckin
      tags:
        - Daily Checkin
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              $ref: '#/components/schemas/DailyCheckinDTO'
      responses:
        "200":
          description: "Daily Checkin saved successfully"
        "400":
          description: "Bad Request"
  
  /checkin/status:
    get:
      operationId: getDailyCheckinStatus
      tags:
        - Daily Checkin
      parameters:
        - name: checkInDate
          in: query
          required: true
          schema:
            type: string
            format: date
      responses:
        "200":
          description: "Daily Checkin status fetched successfully"
          content:
            application/json:
              schema:
                type: boolean
        "400":
          description: "Bad Request"

  /journalEntry:
    post:
      operationId: saveJournalEntry
      tags:
        - Journal Entry
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              $ref: '#/components/schemas/JournalEntryDTO'
      responses:
        "200":
          description: "Journal Entry saved successfully"
          content:
            application/json:
              schema:
                type: long
        "400":
          description: "Bad Request"

    get:
      operationId: getJournalEntries
      tags:
        - Journal Entry
      parameters:
        - name: startDate
          in: query
          schema:
            type: string
            format: date
        - name: endDate 
          in: query
          schema:
            type: string
            format: date
        - name: page
          in: query
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          schema:
            type: integer
            default: 10
      responses:
        "200":
          description: "Journal Entries fetched successfully"
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/JournalEntryDTO'
        "400":
          description: "Bad Request"
  
  /journalEntry/{id}:
    get:
      operationId: getJournalEntry
      tags:
        - Journal Entry
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: long
      responses:
        "200":
          description: "Journal Entry fetched successfully"
          content:
            application/json:
              schema:
                type: object
                $ref: '#/components/schemas/JournalEntryDTO'
        "400":
          description: "Bad Request"

    patch:
      operationId: updateJournalEntry
      tags:
        - Journal Entry
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: long
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              $ref: '#/components/schemas/JournalEntryDTO'
      responses:
        "200":
          description: "Journal Entry updated successfully"
        "400":
          description: "Bad Request"

    delete:
      operationId: deleteJournalEntry
      tags:
        - Journal Entry
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: long
      responses:
        "200":
          description: "Journal Entry deleted successfully"
        "400":
          description: "Bad Request"
  
  /sanctuaryPlan:
    post:
      operationId: createSanctuaryPlan
      tags:
        - Sanctuary Plan
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              $ref: '#/components/schemas/SanctuaryPlanDTO'
      responses:
        "200":
          description: "Sanctuary Plan created successfully"
        "400":
          description: "Bad Request"
  /sanctuaryPlan/{id}:
    patch:
      operationId: updateSanctuaryPlan
      tags:
        - Sanctuary Plan
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: long
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              $ref: '#/components/schemas/SanctuaryPlanDTO'
      responses:
        "200":
          description: "Sanctuary Plan updated successfully"
          content:
            application/json:
              schema:
                type: object
                $ref: '#/components/schemas/SanctuaryPlanDTO'
        "400":
          description: "Bad Request"
  
  /supportTool:
    post:
      operationId: createSupportTool
      tags:
        - Support Tool
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              $ref: '#/components/schemas/SupportToolDTO'
      responses:
        "200":
          description: "Support Tool created successfully"
        "400":
          description: "Bad Request"
components:
  schemas:
    SupportToolDTO:
      type: object
      properties:
        answer:
          type: object
          additionalProperties:
            type: string
        supportToolCategory:
          type: string
          enum:
            - BREATHING_EXCERSISE
            - MEDITATION
            - IDENTIFICATION_TOOL
            - STRESS_RELIEF
    SanctuaryPlanDTO:
      type: object
      properties:
        name:
          type: string
        startDate:
          type: string
          format: date
        endDate:
          type: string
          format: date
        sanctuaryQuestions:
          type: array
          items:
            $ref: '#/components/schemas/SanctuaryQuestionDTO'
        sanctuaryActivities:
          type: array
          items:
            $ref: '#/components/schemas/SanctuaryActivityDTO'
        sanctuarySignatures:
          type: array
          items:
            $ref: '#/components/schemas/SanctuarySignatureDTO'
    SanctuaryQuestionDTO:
      type: object
      properties:
        question:
          type: string
        answer:
          type: string
        category:
          type: string
          enum:
            - CARE
            - WARNING
            - PLAN
            - SUPPORT
    SanctuaryActivityDTO:
      type: object
      properties:
        activityQuestion:
          type: string
        activityAnswer:
          type: string
    SanctuarySignatureDTO:
      type: object
      properties:
        signature:
          type: string
        date:
          type: date
    JournalEntryDTO:
      type: object
      properties:
        id:
          type: long
        entryDate:
          type: string
          format: date-time
        title:
          type: string
        content:
          type: string
        relatedLossId:
          type: long
        cognitiveDistortionsJson:
          type: string
        emotionalTone:
          type: string
      required:
        - entryDate
        - title
        - content
    DailyCheckinDTO:
      type: object
      properties:
        lossId:
          type: long
        checkInDate:
          type: string
          format: date
        griefIntensity:
          type: integer
          minimum: 0
          maximum: 10
        emotionsCsv:
          type: string
        notes:
          type: string
      required:
        - lossId
        - checkInDate
        - griefIntensity
        - emotionsCsv
    FamilyConflictAnswerDTO:
        type: object
        properties:
          assessmentId:
            type: long
          questionId:
            type: long
          valueText:
            type: string
        required:
          - questionId
          - valueText
          - assessmentId
    CompletionStatus:
      type: string
      enum:
        - COMPLETED
        - LOSS_PENDING
        - DIFFICULTY_PENDING
        - BELIEF_PENDING
        - AVOIDENCE_PENDING
        - FAMILY_CONFLICT_PENDING
    FamilyConflictQuestionDTO:
      type: object
      properties:
        id: 
          type: long
        sectionId:
          type: string
        fieldId:
          type: string
        question:
          type: string
        type:
          $ref: '#/components/schemas/QuestionType'
        options:
          type: array
          items:
            type: string
      required:
        - fieldId
        - question
        - type
        - sectionId
    AvoidenceEntryDTO:
      type: object
      properties:
        avoidenceStatementId:
          type: long
        rating:
          type: integer
        relatedLoss:
          type: long
    BeliefEntryDTO:
      type: object
      properties:
        beliefStatementId: 
          type: long
        rating:
          type: integer
        relatedLoss:
          type: long
    DifficultTimes:
      type: object
      properties:
        dayOrTime:
          type: string
        difficulty:
          $ref: "#/components/schemas/DifficultyLevel"
        related_loss:
          type: long
    LossDTO:
      type: object
      properties:
        id:
          type: long
        type:
          $ref: "#/components/schemas/LossType"
        description:
          type: string
        difficulty:
          $ref: "#/components/schemas/DifficultyLevel"
        time:
          type: string
      required:
        - type
        - description
        - difficulty
        - time
    QuestionType:
      type: string
      enum:
        - DESCRIPTIVE
        - RADIO
        - MCQ
        - MCQ_MULTI
    LossType:
      type: string
      enum:
        - RELATIONSHIP
        - THING
        - IDENTITY
    DifficultyLevel:
      type: string
      enum:
        - ZERO
        - ONE
        - TWO
        - THREE
        - FOUR
    ProfileDTO:
      type: object
      properties:
        firstName:
          type: string
        lastName:
          type: string
        bio:
          type: string
        phoneNumber:
          type: string
        profilePictureUrl:
          type: string
        email:
          type: string
        completionStatus:
          $ref: "#/components/schemas/CompletionStatus"


